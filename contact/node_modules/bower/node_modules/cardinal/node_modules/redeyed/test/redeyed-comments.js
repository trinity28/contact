'use strict';
/*jshint asi: true*/

var test = require('tap').test
  , util = require('util')
  , redeyed = require('..')

function inspect (obj) {
  return util.inspect(obj, false, 5, true)
}

test('adding custom asserts ... ', function (t) {
  t.constructor.prototype.assertSurrounds = function (code, opts, expected) {
    var result = redeyed(code, opts)
    this.equals(result.code, expected, inspect(code) + ' => ' + inspect(expected))
    return this;
  }

  t.end() 
})

test('\nstring config, Line comments', function (t) {
  var opts = { Line: { _default: '*:&' } };
  t.test('\n# ' + inspect(opts), function (t) {

    t.assertSurrounds(
        '// a comment'
      , opts
      , '*// a comment&'
    )
    t.assertSurrounds(
        '// comment then new line\nif (a == 1) return'
      , opts
      , '*// comment then new line&\nif (a == 1) return'
    )
    t.assertSurrounds(
        'var n = new Test();// some comment after\n//more comment\nvar s = 3;'
      , opts
      , 'var n = new Test();*// some co